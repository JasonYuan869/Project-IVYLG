# Dreamschools Case Study API Overview
Here is the high-level API documentation for interacting with the database.
This documentation is structured with types and definitions first, followed by the actual API functions.

## Definitions and Types
### ListingData
| Name  | Required | Type    | Description                                                                          |
|-------|----------|---------|--------------------------------------------------------------------------------------|
| _id   | true     | string  | A unique identifier for this school. Will be autogenerated by MongoDB upon creation. |
| name  | true     | string  | The name of the school (max 60 characters).                                          |
| about | true     | string  | The description of the school (max 2000 characters).                                 |
| image | true     | string  | A URL for the image of the school.                                                   |
| __v   | false     | integer | Internal Mongoose version key. Can safely be ignored.                                |

---
### ApiError
| Name    | Type   | Description                                          |
|---------|--------|------------------------------------------------------|
| success | true   | Whether the API operation succeeded (will be false). |
| error   | string | A description of the error that caused the failure.  |

---
### GetListingResponse
| Name    | Required | Type                 | Description                                                                |
|---------|----------|----------------------|----------------------------------------------------------------------------|
| success | true     | boolean              | Whether the API operation succeeded (will be true).                        |
| data    | true     | array of ListingData | An array of listings from the database. The `_id` field will be populated. |

---
### CreateListingResponse
| Name    | Required | Type        | Description                                         |
|---------|----------|-------------|-----------------------------------------------------|
| success | true     | boolean     | Whether the API operation succeeded (will be true). |
| data    | true     | ListingData | Data of the listing that was just created.          |

---
### UpdateListingResponse
| Name    | Required | Type        | Description                                         |
|---------|----------|-------------|-----------------------------------------------------|
| success | true     | boolean     | Whether the API operation succeeded (will be true). |
| data    | true     | ListingData | Updated data of the listing.                        |

---
### DeleteListingResponse
| Name    | Required | Type        | Description                                         |
|---------|----------|-------------|-----------------------------------------------------|
| success | true     | boolean     | Whether the API operation succeeded (will be true). |
| data    | true     | ListingData | Data of the listing that was just deleted.          |

---
### UploadImageResponse
| Name    | Required | Type    | Description                                               |
|---------|----------|---------|-----------------------------------------------------------|
| success | true     | boolean | Whether the API operation succeeded (will be true).       |
| data    | true     | string  | The public URL of the image on the backend cloud storage. |

## API Reference
Since this project will only be live for a short amount of time, we use `<API Address>` in place of
the actual IP of the server.

### Get School Listings
Get all school listings from the database.
#### Endpoint
```
GET https://<API Address>/api/listings
```
#### Request Body
Should be empty. If not empty, it will be ignored.

#### Responses
| Name            | Type               |
|-----------------|--------------------|
| 200 OK          | GetListingResponse |
| 400 Bad Request | ApiError           |

---
### Create School Listing
Creates a new school listing.
#### Endpoint
```
POST https://<API Address>/api/listings
```
#### Request Body (JSON)
| Name  | Required | Type   | Description                                                               |
|-------|----------|--------|---------------------------------------------------------------------------|
| name  | true     | string | The name of the school (max 60 characters).                               |
| about | true     | string | The description of the school (max 2000 characters).                      |
| image | true     | string | A URL for the image of the school.                                        |

#### Responses
| Name            | Type                  |
|-----------------|-----------------------|
| 200 OK          | CreateListingResponse |
| 400 Bad Request | ApiError              |

---
### Modify School Listing
Modifies an existing school listing.
#### Endpoint
```
PATCH https://<API Address>/api/listings/<id>
```
#### Request Body (JSON)
All fields are optional. If a field is left empty, then the existing data will be preserved.

| Name  | Required | Type   | Description                                          |
|-------|----------|--------|------------------------------------------------------|
| name  | false    | string | The name of the school (max 60 characters).          |
| about | false    | string | The description of the school (max 2000 characters). |
| image | false    | string | A URL for the image of the school.                   |

#### Responses
| Name            | Type                  |
|-----------------|-----------------------|
| 200 OK          | UpdateListingResponse |
| 400 Bad Request | ApiError              |

---
### Delete School Listing
Deletes an existing school listing.
#### Endpoint
```
DELETE https://<API Address>/api/listings/<id>
```
#### Request Body (JSON)
Should be empty. If not empty, it will be ignored.

#### Responses
| Name            | Type                  |
|-----------------|-----------------------|
| 200 OK          | DeleteListingResponse |
| 400 Bad Request | ApiError              |

---
### Upload Image
Uploads an image to the backend database (Google Cloud Storage)
#### Endpoint
```
POST https://<API Address>/api/upload
```
#### Request Body
Must contain the file (`image/png` or `image/jpg`) encoded with `multipart/form-data`.

#### Responses
| Name            | Type                |
|-----------------|---------------------|
| 200 OK          | UploadImageResponse |
| 400 Bad Request | ApiError            |
